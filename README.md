# Tzolkin Tracker (tzolkin_calculator)

Небольшой трекер 13‑дневных «волн» (Tzolkin): показывает текущий день (тон + печать), позволяет ежедневно отвечать на вопросы/вести заметку, сохраняет данные в Supabase и умеет запрашивать ИИ‑совет/анализ волны через API.

## Что умеет

- Расчёт Kin / тона / печати по дате
- Ежедневные ответы (энергия, резонанс, делать/быть, стадия проекта, инсайт, заметки)
- Сохранение и история заполненных дней (Supabase)
- ИИ‑совет на день и анализ 13‑дневной волны (Anthropic Claude через `api/`)
- Поддержка Telegram Web App (скрипт `telegram-web-app.js` подключён)

## Технологии

- Frontend: React 18 через CDN + Babel Standalone (JSX прямо в браузере)
- UI: Tailwind через CDN
- Storage: Supabase
- Backend API: serverless‑роуты в папке `api/` (подход совместим с Vercel)
- AI: Anthropic Messages API (Claude)

## Структура проекта

- `index.html` — подключение библиотек и всех `*.jsx` файлов
- `App.jsx` и остальные `*.jsx` — экраны/компоненты приложения
- `api/analyze-day.js` — POST `/api/analyze-day` (совет на день)
- `api/analyze-wave.js` — POST `/api/analyze-wave` (анализ волны)
- `api/telegram.js` — обработчик Telegram webhook (если используется)

## Запуск локально (только фронт)

Приложение использует относительные `*.jsx` файлы и запросы на `/api/...`, поэтому лучше открывать не через `file://`, а через локальный HTTP‑сервер.

Вариант 1 (Python):

```bash
python -m http.server 8000
```

Открыть: `http://localhost:8000`

Вариант 2 (Node):

```bash
npx serve .
```

Важно: в этом режиме запросы к `/api/analyze-day` и `/api/analyze-wave` не будут работать (нечему их обслуживать), если вы не запускаете serverless‑окружение.

## Запуск API / деплой

Папка `api/` выглядит как serverless‑функции (типично для Vercel). При деплое на платформу, которая поддерживает такой формат, роуты будут доступны как:

- `POST /api/analyze-day`
- `POST /api/analyze-wave`

### Переменные окружения

Для работы ИИ‑анализа нужно добавить переменную окружения:

- `CLAUDE_API_KEY` — ключ Anthropic

## Supabase

Фронт использует Supabase JS клиент и сохраняет данные в таблицу `user_days`.

Минимально ожидаемые поля (по коду сохранения):

- `user_id` (string)
- `date` (string/DATE)
- `kin` (number)
- `tone` (number)
- `seal` (number)
- `energy`, `resonance`, `action`, `project`, `insight` (string)
- `notes` (string)

Примечание: если у вас включён RLS, потребуется настроить политики доступа так, чтобы записи были доступны для чтения/записи (в текущей реализации используется локальный `user_id` из `localStorage`).

## Примечание по безопасности

Сейчас в репозитории есть чувствительные данные, которые обычно выносят в переменные окружения (например, ключи/токены). Для публичного репозитория это стоит обязательно пересмотреть.
